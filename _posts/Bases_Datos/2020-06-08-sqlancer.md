---

author_profile: true
comments: false
classes: wide
tags:
- SQLancer
categories:
- Bases de Datos
header:
  teaser: /assets/images/blog/logo-sqlancer.webp
  overlay_image: /assets/images/blog/logo-sqlancer.webp
  overlay_filter: 0.2
  image_description: 'SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).'
  image_alt: 'SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).'
title: 'SQLancer: Detecci√≥n de errores l√≥gicos en DBMS o sistema de gesti√≥n de bases de datos'
description: >-
  SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).
excerpt: >-
  SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).
canonical_URL: https://ciberninjas.com/sqlancer/
permalink: /sqlancer/
date: 2020-06-09 18:32:32
last_modified_at: 
published: true

---

SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).

SQLancer opera en las siguientes dos fases:

- Generaci√≥n de base de datos: El objetivo de esta fase es crear una base de datos poblada y hacer hincapi√© en el DBMS para aumentar la probabilidad de causar un estado de base de datos inconsistente que podr√≠a detectarse posteriormente. Primero, se crean tablas aleatorias. Luego, se eligen al azar sentencias SQL para generar, modificar y eliminar datos. Tambi√©n se env√≠an al DBMS otras declaraciones, como aquellas para crear √≠ndices, as√≠ como vistas y para establecer opciones espec√≠ficas de DBMS.
- Pruebas: el objetivo de esta fase es detectar los errores l√≥gicos basados ‚Äã‚Äãen la base de datos generada. Vea los enfoques de prueba a continuaci√≥n.

## **Empezando con SQLancer**

Requisitos:

- Java 11
- [Maven](https://maven.apache.org/){:target="_blank" rel="nofollow,noreferrer"} ( `sudo apt install maven`en Ubuntu)
- El DBMS que desea probar (SQLite es un DBMS incorporado y est√° incluido)

Los siguientes comandos clonan SQLancer, crean un JAR e inician SQLancer para difuminar SQLite usando el Particionamiento de consultas l√≥gicas ternarias (TLP):

```
git clone https://github.com/sqlancer/sqlancer
cd sqlancer
mvn package
cd target
java -jar SQLancer-0.0.1-SNAPSHOT.jar --num_threads 16 --num_tries 5 --max_expression_depth 3 --num_queries 100000 --max_num_inserts 30 sqlite3 --oracle query_partitioning
```

Si la ejecuci√≥n imprime informaci√≥n de progreso cada cinco segundos, la herramienta funciona como se esperaba. Tenga en cuenta que SQLancer puede encontrar errores en SQLite. Antes de informar sobre esto, aseg√∫rese de verificar que todav√≠a puedan reproducirse cuando use la √∫ltima versi√≥n de desarrollo.

Si inicia SQLancer sin par√°metros, se muestran las opciones y comandos disponibles.

## **Prototipo de investigaci√≥n**

Este proyecto en esta etapa a√∫n debe verse como un prototipo de investigaci√≥n. Creemos que la herramienta no est√° lista para ser utilizada. Sin embargo, hemos recibido muchas solicitudes de empresas, organizaciones y desarrolladores individuales, por lo que decidimos lanzar la herramienta prematuramente. Espere errores, incompatibilidades, falta de documentaci√≥n y calidad de c√≥digo insuficiente. Dicho esto, estamos trabajando arduamente para abordar estos problemas y mejorar SQLancer para convertirnos en una pieza de software de calidad de producci√≥n. Damos la bienvenida a cualquier informe de problemas, solicitudes de extensi√≥n y contribuciones de c√≥digo.

## **Enfoques de Pruebas**

| Acercarse                                                    | Descripci√≥n                                                  |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| S√≠ntesis de consulta pivotada (PQS)                          | PQS es la primera t√©cnica que dise√±amos e implementamos. Selecciona aleatoriamente una fila, llamada fila din√°mica, para la cual se genera una consulta que se garantiza que recuperar√° la fila. Si la fila no est√° contenida en el conjunto de resultados, se ha detectado un error. Se describe completamente [aqu√≠](https://arxiv.org/abs/2001.04174){:target="_blank" rel="nofollow,noreferrer"}. PQS es la t√©cnica m√°s poderosa, pero tambi√©n requiere m√°s esfuerzo de implementaci√≥n que las otras dos t√©cnicas. Actualmente est√° sin mantenimiento. |
| Construcci√≥n del motor de referencia sin optimizaci√≥n (NoREC) | NoREC tiene como objetivo encontrar errores de optimizaci√≥n. Se describe [aqu√≠](https://www.manuelrigger.at/preprints/NoREC.pdf){:target="_blank" rel="nofollow,noreferrer"}. Traduce una consulta que es potencialmente optimizada por el DBMS a una para la que casi ninguna optimizaci√≥n es aplicable, y compara los dos conjuntos de resultados. Una falta de coincidencia entre los conjuntos de resultados indica un error en el DBMS. |
| Particionamiento l√≥gico ternario (TLP)                       | TLP divide una consulta en tres consultas de partici√≥n, cuyos resultados se componen y se comparan con el conjunto de resultados de la consulta original. Una falta de coincidencia en los conjuntos de resultados indica un error en el DBMS. A diferencia de NoREC y PQS, puede detectar errores en funciones avanzadas como funciones agregadas. |

## **DBMS Soportado**

Dado que los dialectos de SQL difieren ampliamente, cada DBMS a probar requiere una implementaci√≥n separada.

| DBMS        | Estado     | Generaci√≥n de expresiones | Descripci√≥n                                                  |
| ----------- | ---------- | ------------------------- | ------------------------------------------------------------ |
| SQLite      | Trabajando | Sin tipo                  | Actualmente, esta implementaci√≥n se ve afectada por una regresi√≥n significativa del rendimiento que a√∫n debe investigarse |
| MySQL       | Trabajando | Sin tipo                  | La ejecuci√≥n de esta implementaci√≥n probablemente descubre errores adicionales no reportados. |
| PostgreSQL  | Trabajando | Mecanografiado            |                                                              |
| MariaDB     | Preliminar | Sin tipo                  | La implementaci√≥n de este DBMS es muy preliminar, ya que dejamos de extenderlo despu√©s de que se abordaron todos menos uno de nuestros informes de errores. Ejecutarlo probablemente descubre errores adicionales no reportados. |
| CucarachaDB | Trabajando | Mecanografiado            |                                                              |
| TiDB        | Trabajando | Sin tipo                  |                                                              |
| DuckDB      | Trabajando | Sin tipo, Gen√©rico        |                                                              |
| ClickHouse  | Preliminar | Sin tipo, Gen√©rico        | Implementar los diferentes motores de tabla no era conveniente, por lo que solo existe una implementaci√≥n muy preliminar. |
| TDEngine    | Remoto     | Sin tipo                  | Eliminamos la implementaci√≥n de TDEngine, ya que todos menos uno de nuestros informes de errores a√∫n no fueron abordados cinco meses despu√©s de que los informamos. |

# **Integraci√≥n continua y conjunto de pruebas**

Para mejorar y mantener la calidad del c√≥digo de SQLancer, utilizamos varias herramientas:

- El [formateador de c√≥digo Eclipse](https://code.revelc.net/formatter-maven-plugin/){:target="_blank" rel="nofollow,noreferrer"}, para garantizar un formato consistente (Ejecutar `mvn formatter:format`para formatear todos los archivos).
- [Checkstyle](https://checkstyle.sourceforge.io/){:target="_blank" rel="nofollow,noreferrer"}, para imponer un est√°ndar de codificaci√≥n consistente.
- [PMD](https://pmd.github.io/){:target="_blank" rel="nofollow,noreferrer"}, que encuentra fallas de programaci√≥n mediante an√°lisis est√°tico.
- [SpotBugs](https://spotbugs.github.io/){:target="_blank" rel="nofollow,noreferrer"}, que tambi√©n utiliza an√°lisis est√°tico para encontrar errores y fallas de programaci√≥n.

Puede ejecutarlos con el siguiente comando:

```
mvn verify
```

Planeamos agregar pronto un [CI](https://github.com/sqlancer/sqlancer/issues/2){:target="_blank" rel="nofollow,noreferrer"} para verificar autom√°ticamente los RP. Posteriormente, tambi√©n planeamos agregar pruebas de humo para cada DBMS para probar que la implementaci√≥n de prueba respectiva no est√° obviamente rota, vea [aqu√≠](https://github.com/sqlancer/sqlancer/issues/3){:target="_blank" rel="nofollow,noreferrer"}.

SQLancer actualmente no tiene un conjunto de pruebas. Descubrimos que los errores en SQLancer se encuentran r√°pidamente y son f√°ciles de depurar al probar el DBMS. La implementaci√≥n de PQS ten√≠a un conjunto de pruebas, que se elimin√≥ en commit 36ede0c0c68b3856e03ef5ba802a7c2575bb3f12.

## **Registros de SQLancer**

SQLancer almacena registros en el subdirectorio `target/logs`. De manera predeterminada, la opci√≥n `--log-each-select` est√° habilitada, lo que da como resultado que se registre cada instrucci√≥n SQL que se env√≠e al DBMS. Los nombres de los archivos correspondientes se posponen con `-cur.log`. Adem√°s, si SQLancer detecta un error l√≥gico, crea un archivo con la extensi√≥n `.log`, en el que se registran las declaraciones para reproducir el error.

## **Implementaci√≥n de soporte para un nuevo DBMS**

La implementaci√≥n de DuckDB proporciona una buena plantilla para una nueva implementaci√≥n. La clase `DuckDBProvider` es la clase central que gestiona la creaci√≥n de las bases de datos y ejecuta los or√°culos de prueba seleccionados. Intente copiar su estructura para el nuevo DBMS que desea implementar y comience por generar bases de datos (sin implementar un or√°culo de prueba). Como parte de esto, tambi√©n deber√° implementar el equivalente de `DuckDBSchema`, que representa el esquema de la base de datos de la base de datos generada. Despu√©s de que pueda generar bases de datos con √©xito, el siguiente paso es generar uno de los or√°culos de prueba. Por ejemplo, es posible que desee implementar NoREC (consulte `DuckDBNoRECOracle` o `DuckDBQueryPartitioningWhereTester` para TLP). Como parte de esto, tambi√©n debe implementar un generador de expresiones aleatorias (consulte `DuckDBExpressionGenerator`) y un visitante para derivar la representaci√≥n textual de una expresi√≥n (ver `DuckDBToStringVisitor`).

## **SQLancer con Eclipse**

Se espera que el desarrollo de SQLancer usando Eclipse funcione bien. Puede importar SQLancer con un solo paso:

```
File -> Import -> Existing Maven Projects -> Select the SQLancer directory as root directory -> Finish
```

Si no encuentra una opci√≥n para importar proyectos de Maven, es posible que deba instalar el [complemento M2Eclipse](https://www.eclipse.org/m2e/){:target="_blank" rel="nofollow,noreferrer"}.

## **Comunidad de SQLancer**

Hemos creado un [espacio](https://join.slack.com/t/sqlancer/shared_invite/zt-eozrcao4-ieG29w1LNaBDMF7OB_~ACg){:target="_blank" rel="nofollow,noreferrer"} de [trabajo de Slack](https://join.slack.com/t/sqlancer/shared_invite/zt-eozrcao4-ieG29w1LNaBDMF7OB_~ACg){:target="_blank" rel="nofollow,noreferrer"} para analizar SQLancer y las pruebas de DBMS en general. El identificador oficial de Twitter de [SQLancer](https://twitter.com/sqlancer_dbms){:target="_blank" rel="nofollow,noreferrer"} es [@sqlancer_dbms](https://twitter.com/sqlancer_dbms){:target="_blank" rel="nofollow,noreferrer"}.

## **Recursos adicionales**

- Una charla de S√≠ntesis de consulta pivotada (anterior) (PQS) est√° disponible en [YouTube](https://www.youtube.com/watch?v=yzENTaWe7qg){:target="_blank" rel="nofollow,noreferrer"}.
- PingCAP ha implementado PQS en una herramienta llamada [wreck-it](https://github.com/chaos-mesh/wreck-it){:target="_blank" rel="nofollow,noreferrer"}.
- M√°s informaci√≥n sobre nuestros esfuerzos de prueba de DBMS y los errores que encontramos est√° disponible [aqu√≠](https://www.manuelrigger.at/dbms-bugs/){:target="_blank" rel="nofollow,noreferrer"}.

üî• Seguro tambi√©n te interesa: [C√≥mo aprender Python en 2020](/python/), [ü•á ‚ñ∑ C√≥mo aprender aprendizaje autom√°tico o machine learning en 2020 ü§ñ](/que-aprender-sobre-machine-learning-2020/), [‚ñ∑ M√°s de 200 de los mejores tutoriales de aprendizaje autom√°tico, PNL y Python](/aprendizaje-automatico-cursos-ingles/)
{: .notice--danger}

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<ins class="adsbygoogle"
     style="display:block; text-align:center;"
     data-ad-layout="in-article"
     data-ad-format="fluid"
     data-ad-client="ca-pub-9630764103400456"
     data-ad-slot="3229974124"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

![SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).](/assets/images/blog/logo-sqlancer.webp "SQLancer (Synthesized Query Lancer) es una herramienta para probar autom√°ticamente los sistemas de gesti√≥n de bases de datos (DBMS) para encontrar errores l√≥gicos en su implementaci√≥n. Nos referimos a los errores l√≥gicos como aquellos errores que hacen que el DBMS obtenga un conjunto de resultados incorrecto (por ejemplo, al omitir un registro).")

[üéÅ Visita Nuestra Tienda üéÅ](https://www.amazon.es/shop/cibercursos){: .btn .btn--warning .btn--large .align-center}{:target="_blank" rel="nofollow,noreferrer"}